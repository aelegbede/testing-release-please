name: Generate-Release-Note

on:
  push:
    branches: 
     - '[0-9]+-*'

jobs:
  Release-Note:
    runs-on: ubuntu-latest
    steps:


      - name: Get Path name
        id: path
        run: |
          branch=${{ github.ref_name }} 
          split_branch=(${branch//-/ }) 
          path=${split_branch[0]}
          package=${split_branch[1]}
          echo "$path $package"
          echo '::set-output name=slnpath::$(echo $path)'
          echo '::set-output name=package::$(echo $package)'


      - uses: google-github-actions/release-please-action@v3
        id: release
        with:
          release-type: node
          package-name: ${{ steps.path.output.package }} 
          path: 5510
          default-branch: ${{ github.ref_name }}
          monorepo-tags: true
          extra-files: |
            README.md
            VERSION.md
 
       
#      - name: Checkout
#        uses: actions/checkout@v2
#        with:
#          path: cloned-repo
          
      # - name: tag major and minor versions
      #   #if: ${{ steps.release.outputs.release_created }}
      #   run: |
      #     cd  cloned-repo
      #     git config user.name github-actions[bot]
      #     git config user.email 41898282+github-actions[bot]@users.noreply.github.com
      #     git tag -d v${{ steps.release.outputs.major }} || true
      #     git tag -d v${{ steps.release.outputs.major }}.${{ steps.release.outputs.minor }} || true
      #     git push origin :v${{ steps.release.outputs.major }} || true
      #     git push origin :v${{ steps.release.outputs.major }}.${{ steps.release.outputs.minor }} || true
      #     git tag -a v${{ steps.release.outputs.major }} -m "Release v${{ steps.release.outputs.major }}"
      #     git tag -a v${{ steps.release.outputs.major }}.${{ steps.release.outputs.minor }} -m "Release v${{ steps.release.outputs.major }}.${{ steps.release.outputs.minor }}"
      #     git push origin v${{ steps.release.outputs.major }}
      #     git push origin v${{ steps.release.outputs.major }}.${{ steps.release.outputs.minor }}
